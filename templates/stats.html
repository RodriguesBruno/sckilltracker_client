{% extends "base.html" %}

{% block content %}
<div class="content">
  <h2>Statistics</h2>

<!--  <div class="stats-section">-->
<!--    <h3>Top Victims</h3>-->
<!--    <ul>-->
<!--      {% for item in top_victims %}-->
<!--        <li>{{ item.victim_player_name }} — {{ item.count }} deaths</li>-->
<!--      {% endfor %}-->
<!--    </ul>-->
<!--  </div>-->

<!--  <div class="stats-section">-->
<!--    <h3>Top Killers</h3>-->
<!--    <ul>-->
<!--      {% for item in top_killers %}-->
<!--        <li>{{ item.killed_by }} — {{ item.count }} kills</li>-->
<!--      {% endfor %}-->
<!--    </ul>-->
<!--  </div>-->

<!--  <div class="stats-section">-->
<!--    <h3>Kills by Game Mode</h3>-->
<!--    <ul>-->
<!--      {% for item in kills_by_mode %}-->
<!--        <li>{{ item.game_mode }} — {{ item.count }}</li>-->
<!--      {% endfor %}-->
<!--    </ul>-->
<!--  </div>-->

<!--  <div class="stats-section">-->
<!--    <h3>Damage Type Distribution</h3>-->
<!--    <ul>-->
<!--      {% for item in damage_distribution %}-->
<!--        <li>{{ item.damage }} — {{ item.count }}</li>-->
<!--      {% endfor %}-->
<!--    </ul>-->
<!--  </div>-->

  <div class="chart-row">
    <div class="chart-container shadowed-chart">
      {{ top_victims_chart | safe }}
    </div>

    <div class="chart-container shadowed-chart">
      {{ top_killers_chart | safe }}
    </div>
  </div>

  <div class="chart-row">

    <div class="chart-container shadowed-chart">
      {{ game_mode_chart | safe }}
    </div>

    <div class="chart-container shadowed-chart">
      {{ damage_chart  | safe }}
    </div>

  </div>

</div>

<script>
document.addEventListener('DOMContentLoaded', function () {
  setTimeout(function () {
    const victimsChart = document.getElementById('top-victims-chart');

    if (victimsChart) {
      victimsChart.on('plotly_click', function (data) {
        const url = data.points[0].customdata[0];
        if (url) {
          window.open(url, '_blank');
        }
      });
    } else {
      console.warn("Chart not found: #top-victims-chart");
    }
  }, 250);

  setTimeout(function () {
  const killersChart = document.getElementById('top-killers-chart');

  if (killersChart) {
    killersChart.on('plotly_click', function (data) {
      const url = data.points[0].customdata[0];
      if (url) {
        window.open(url, '_blank');
      }
    });
    } else {
      console.warn("Chart not found: #top-killers-chart");
    }
  }, 250);


});
</script>

{% endblock %}